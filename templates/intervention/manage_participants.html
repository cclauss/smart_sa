{% extends "base.html" %} 

{% block title %}Administrate{% endblock %}

{% block breadcrumb-main %} 
<div id="breadcrumb-main">
	<a href="/intervention/">Home</a> &rarr; Administrate 
</div>
{% endblock %} 

{% block content %} 
<h2>
	Administrate
</h2>

{% if request.user.is_superuser %}
<a style="float: right; margin-top: -5px;" class="action" href="/manage/report/download/">Download Participant Data</a>

<form action="/set_deployment/" method="post">
<p>Location Name: <input type="text" name="name"
		      value="{{deployment.name}}" />
<input type="submit" value="Save" /></p>
</form>
{% endif %}

<h4>
	Participants
</h4>


{% if participants %} 
<table class="manage" cellspacing="0">
	<col id="firstname" /> 
	<col id="status" /> 
	<col id="actions" /> 
	<tr>
	<td colspan="3" class="addcell">
<a class="action" href="/manage/add_participant/">+ Add a Participant</a>	
</td>
	</tr>
	<tr>
		<th>First Name</th>
		<th>Status</th>
		<th>Actions</th>
	</tr>
	{% for participant in participants %} 
	<tr>
		<td>{{participant.name}}</td>
		<td>{% if participant.status %}Active{% else %}Inactive{% endif %}</td>
		<td> <a class="action" href="/manage/participant/{{participant.id}}/view/">View Info for {{participant.name}}</a> <a class="action" href="/manage/participant/{{participant.id}}/edit/">Edit Info for {{participant.name}}</a> </td>
	</tr>
	{% endfor %} 
</table>
{% else %} 
<p>
	no participants
</p>
{% endif %} 
{% if request.user.is_superuser %}
<h4>
	Counselors 
</h4>
{% if counselors %} 
<table id="counselors" class="manage" cellspacing="0">
	<col id="firstname" /> <col id="status" /> <col id="actions" /> 
	<tr>
	<td colspan="3" class="addcell">
	  {% if request.user.is_superuser %}
	    <a class="action" href="/manage/add_counselor/">+ Add a Counselor</a>	
          {% endif %}
	</td>
	</tr>
	<tr>
		<th>First Name</th>
		<th>Status</th>
		<th>Actions</th>
	</tr>
	{% for counselor in counselors %} 
	<tr>
		<td>{{counselor.username}}</td>
		<td>{% if counselor.is_active %}Active{% else %}Inactive{% endif %}</td>
		<td><a class="action" href="/admin/auth/user/{{counselor.id}}/">Edit Info for {{counselor.username}}</a> </td>
	</tr>
	{% endfor %} 
</table>
{% else %} 
<p>
	no counselors
</p>
{% endif %}
{% endif %}

{% if not deployment.is_online %}
{% if request.user.is_superuser %}
<h4>Restore Participant/Counselor Data</h4>
<p>Warning: this will overwrite the participant/counselor data on this
  machine. Only do this as an emergency recovery procedure. Please
  make sure you have selected the correct backup file to restore
  from. </p>

<form action="/manage/restore_participants/" method="post"
  enctype="multipart/form-data" />
<p>Select that participant data file that you wish to restore from (it
  will be named something like <b>"&lt;clinic&gt;_&lt;timestamp&gt;_participant_data.json"</b>)
<input type="file" name="participants_data" /></p>
<input type="submit" value="restore" />
</form>

<h4>Update Intervention Content</h4>
<p>If the intervention content (text, images, and/or video) has been
  updated, this is where you update the Clinic deployment by uploading
  the .zip file of the new content.</p>

<form action="/manage/update_intervention_content/" method="post" enctype="multipart/form-data" />
<p>Select that intervention content file that you wish to restore from (it
  will be named something like <b>"&lt;timestamp&gt;_content.zip"</b>)
<input type="file" name="intervention_content.zip" /></p>
<input type="submit" value="update content" />
</form>


{% endif %}
{% endif %}
{% endblock %} 
